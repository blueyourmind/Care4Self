<!DOCTYPE html>
<html lang="en" turbo-action="replace">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Care4self</title>

    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
   <%# <%= javascript_include_tag 'application/service_worker' %>

    <%= stylesheet_link_tag "https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css", "data-turbo-track": "reload" %>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@500&display=swap" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Urbanist:wght@200&display=swap" rel="stylesheet">
    <%# <%= stylesheet_link_tag "application", "data-turbo-track": "reload" %>
    <%# <%= javascript_include_tag "application", "data-turbo-track": "reload", defer: true %>
    <link href="https://fonts.googleapis.com/css2?family=Hammersmith+One&display=swap" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
     <script src="https://cdn.jsdelivr.net/npm/actioncable"></script>
     <script>
     const cable = ActionCable.createConsumer("ws://localhost:3000/cable");
    </script>

    <%= javascript_include_tag 'application', 'data-turbolinks-track': 'reload' %>
    <%= stylesheet_link_tag 'application', 'data-turbolinks-track': 'reload' %>
    <link href="https://fonts.googleapis.com/css2?family=Anton&family=Teko:wght@300&display=swap" rel="stylesheet">
    <%= javascript_include_tag "application", "data-turbo-track": "reload", defer: true %>
    <%= javascript_include_tag "https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js", "data-turbo-track": "reload"%>


  </head>

  <body>







    <%= render "shared/flashes" %>
<%= render "shared/navbar" %>

  <%= yield %>

<div id="notificationsContainer"></div>


 <%= render "shared/footer"%>

<script>
function fetchNotifications() {
  fetch('/notifications')
    .then(response => response.json())
    .then(data => {
      displayNotifications(data);
    })
    .catch(error => console.error('Error fetching notifications:', error));
}

// Fetch notifications every minute (adjust as needed)
setInterval(fetchNotifications, 60000);

// Display notifications on the frontend
function displayNotifications(notifications) {
  const notificationsContainer = document.getElementById('notificationsContainer');

  // Clear existing notifications
  notificationsContainer.innerHTML = '';

  // Iterate through notifications and append to the container
  notifications.forEach(notification => {
    const notificationCard = createNotificationCard(notification);
    notificationsContainer.appendChild(notificationCard);
  });
}

// Helper function to create a notification card
function createNotificationCard(notification) {
  const card = document.createElement('div');
  card.classList.add('notification-card');

  // Add content to the card
  const message = document.createElement('p');
  message.textContent = notification.message; // Adjust this based on your Notification model
  card.appendChild(message);

  // Add a close button
  const closeButton = document.createElement('button');
  closeButton.textContent = 'Close';
  closeButton.addEventListener('click', () => {
    // Logic to handle closing the notification, e.g., remove it from the UI or mark it as read
    card.remove();
  });
  card.appendChild(closeButton);

  return card;
}
</script>






</body>
</html>
